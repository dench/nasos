/*
 Copyright (c) 2008 Yii Software LLC
 @license http://www.yiiframework.com/license/
 @author Qiang Xue <qiang.xue@gmail.com>
 @since 2.0
*/
window.yii=function(c){function q(){c.ajaxPrefilter(function(a,b,d){!a.crossDomain&&e.getCsrfParam()&&d.setRequestHeader("X-CSRF-Token",e.getCsrfToken())});e.refreshCsrfToken()}function u(){c(document).ajaxComplete(function(a,b){(a=b&&b.getResponseHeader("X-Redirect"))&&window.location.assign(a)})}function v(){var a={};c("script[src]").each(function(){var b=k(this.src);a[b]=!0});c.ajaxPrefilter("script",function(b,d,c){if("jsonp"!=b.dataType){b=k(b.url);d=!0===a[b]&&!m(b);var e=void 0!==a[b]&&!0===
a[b].xhrDone;if(d||e)c.abort();else{if(void 0===a[b]||!0===a[b])a[b]={xhrList:[],xhrDone:!1};c.done(function(b,d,c){if(!0!==a[c.yiiUrl].xhrDone){a[c.yiiUrl].xhrDone=!0;b=0;for(d=a[c.yiiUrl].xhrList.length;b<d;b++){var e=a[c.yiiUrl].xhrList[b];e&&e.readyState!==XMLHttpRequest.DONE&&e.abort()}a[c.yiiUrl]=!0}}).fail(function(b,d){if("abort"!==d){delete a[b.yiiUrl].xhrList[b.yiiIndex];d=!0;for(var c=0,e=a[b.yiiUrl].xhrList.length;c<e;c++)a[b.yiiUrl].xhrList[c]&&(d=!1);d&&delete a[b.yiiUrl]}});c.yiiIndex=
a[b].xhrList.length;c.yiiUrl=b;a[b].xhrList[c.yiiIndex]=c}}});c(document).ajaxComplete(function(){var a=[];c("link[rel=stylesheet]").each(function(){var b=k(this.href);m(b)||(-1===c.inArray(b,a)?a.push(b):c(this).remove())})})}function w(){var a=function(a){var b=c(this),g=b.data("method"),f=b.data("confirm"),h=b.data("form");if(void 0===g&&void 0===f&&void 0===h)return!0;void 0!==f?c.proxy(e.confirm,this)(f,function(){e.handleAction(b,a)}):e.handleAction(b,a);a.stopImmediatePropagation();return!1};
c(document).on("click.yii",e.clickableSelector,a).on("change.yii",e.changeableSelector,a)}function m(a){for(var b=0;b<e.reloadableScripts.length;b++){var c=k(e.reloadableScripts[b]);if(!0===(new RegExp("^"+c.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").split("\\*").join(".+")+"$")).test(a))return!0}return!1}function k(a){return"/"===a.charAt(0)?e.getBaseCurrentUrl()+a:a}var e={reloadableScripts:[],clickableSelector:'a, button, input[type="submit"], input[type="button"], input[type="reset"], input[type="image"]',
changeableSelector:"select, input, textarea",getCsrfParam:function(){return c("meta[name=csrf-param]").attr("content")},getCsrfToken:function(){return c("meta[name=csrf-token]").attr("content")},setCsrfToken:function(a,b){c("meta[name=csrf-param]").attr("content",a);c("meta[name=csrf-token]").attr("content",b)},refreshCsrfToken:function(){var a=e.getCsrfToken();a&&c('form input[name="'+e.getCsrfParam()+'"]').val(a)},confirm:function(a,b,c){window.confirm(a)?!b||b():!c||c()},handleAction:function(a,
b){var d=a.attr("data-form")?c("#"+a.attr("data-form")):a.closest("form"),g=!a.data("method")&&d?d.attr("method"):a.data("method"),f=a.attr("href"),h=f&&"#"!==f,n=a.data("params"),k=n&&c.isPlainObject(n),l=a.data("pjax");l=void 0!==l&&0!==l&&c.support.pjax;var p={};if(l){var r=a.data("pjax-container")||a.closest("[data-pjax-container]");r.length||(r=c("body"));p={container:r,push:!!a.data("pjax-push-state"),replace:!!a.data("pjax-replace-state"),scrollTo:a.data("pjax-scrollto"),pushRedirect:a.data("pjax-push-redirect"),
replaceRedirect:a.data("pjax-replace-redirect"),skipOuterContainers:a.data("pjax-skip-outer-containers"),timeout:a.data("pjax-timeout"),originalEvent:b,originalTarget:a}}if(void 0===g)if(h)l?c.pjax.click(b,p):window.location.assign(f);else{if(a.is(":submit")&&d.length){if(l)d.on("submit",function(a){c.pjax.submit(a,p)});d.trigger("submit")}}else{var m=!d.length;if(m)h||(f=e.getCurrentUrl()),d=c("<form/>",{method:g,action:f}),(b=a.attr("target"))&&d.attr("target",b),/(get|post)/i.test(g)||(d.append(c("<input/>",
{name:"_method",value:g,type:"hidden"})),g="post",d.attr("method",g)),/post/i.test(g)&&(g=e.getCsrfParam())&&d.append(c("<input/>",{name:g,value:e.getCsrfToken(),type:"hidden"})),d.hide().appendTo("body");else{var q=d.attr("method");d.attr("method",g);if(h){var t=d.attr("action");d.attr("action",f)}}if(g=d.data("yiiActiveForm"))g.submitObject=a;k&&c.each(n,function(a,b){d.append(c("<input/>").attr({name:a,value:b,type:"hidden"}))});if(l)d.on("submit",function(a){c.pjax.submit(a,p)});d.trigger("submit");
c.when(d.data("yiiSubmitFinalizePromise")).then(function(){m?d.remove():(void 0!==t&&d.attr("action",t),d.attr("method",q),k&&c.each(n,function(a){c('input[name="'+a+'"]',d).remove()}))})}},getQueryParams:function(a){var b=a.indexOf("?");if(0>b)return{};a=c.grep(a.substring(b+1).split("#")[0].split("&"),function(a){return""!==a});b={};for(var d=0,e=a.length;d<e;d++){var f=a[d].split("="),h=decodeURIComponent(f[0].replace(/\+/g,"%20"));f=decodeURIComponent(f[1].replace(/\+/g,"%20"));h.length&&(void 0===
b[h]?b[h]=f||"":(c.isArray(b[h])||(b[h]=[b[h]]),b[h].push(f||"")))}return b},initModule:function(a){if(void 0===a.isActive||a.isActive)c.isFunction(a.init)&&a.init(),c.each(a,function(){c.isPlainObject(this)&&e.initModule(this)})},init:function(){q();u();v();w()},getBaseCurrentUrl:function(){return window.location.protocol+"//"+window.location.host},getCurrentUrl:function(){return window.location.href}};return e}(window.jQuery);window.jQuery(function(){window.yii.initModule(window.yii)});
