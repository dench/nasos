/*
 Copyright (c) 2008 Yii Software LLC
 @license http://www.yiiframework.com/license/
 @author Qiang Xue <qiang.xue@gmail.com>
 @since 2.0
*/
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(d,l,g){d instanceof String&&(d=String(d));for(var h=d.length,k=0;k<h;k++){var m=d[k];if(l.call(g,m,k,d))return{i:k,v:m}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(d,l,g){d!=Array.prototype&&d!=Object.prototype&&(d[l]=g.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,l,g,h){if(l){g=$jscomp.global;d=d.split(".");for(h=0;h<d.length-1;h++){var k=d[h];k in g||(g[k]={});g=g[k]}d=d[d.length-1];h=g[d];l=l(h);l!=h&&null!=l&&$jscomp.defineProperty(g,d,{configurable:!0,writable:!0,value:l})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,g){return $jscomp.findInternal(this,d,g).v}},"es6","es3");
(function(d){d.fn.yiiActiveForm=function(a){return m[a]?m[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!==typeof a&&a?(d.error("Method "+a+" does not exist on jQuery.yiiActiveForm"),!1):m.init.apply(this,arguments)};var l={encodeErrorSummary:!0,errorSummary:".error-summary",validateOnSubmit:!0,errorCssClass:"has-error",successCssClass:"has-success",validatingCssClass:"validating",ajaxParam:"ajax",ajaxDataType:"json",validationUrl:void 0,scrollToError:!0,scrollToErrorOffset:0},g=
{id:void 0,name:void 0,container:void 0,input:void 0,error:".help-block",encodeError:!0,validateOnChange:!0,validateOnBlur:!0,validateOnType:!1,validationDelay:500,enableAjaxValidation:!1,validate:void 0,status:0,cancelled:!1,value:void 0,updateAriaInvalid:!0},h,k=function(a){h&&(h.resolve(),h=void 0,a.removeData("yiiSubmitFinalizePromise"))},m={init:function(a,b){return this.each(function(){var c=d(this);if(!c.data("yiiActiveForm")){var e=d.extend({},l,b||{});void 0===e.validationUrl&&(e.validationUrl=
c.attr("action"));d.each(a,function(b){a[b]=d.extend({value:p(c,this)},g,this);v(c,a[b])});c.data("yiiActiveForm",{settings:e,attributes:a,submitting:!1,validated:!1,options:x(c)});c.bind("reset.yiiActiveForm",m.resetForm);e.validateOnSubmit&&(c.on("mouseup.yiiActiveForm keyup.yiiActiveForm",":submit",function(){c.data("yiiActiveForm").submitObject=d(this)}),c.on("submit.yiiActiveForm",m.submitForm));e=d.Event("afterInit");c.trigger(e)}})},add:function(a){var b=d(this);a=d.extend({value:p(b,a)},g,
a);b.data("yiiActiveForm").attributes.push(a);v(b,a)},remove:function(a){var b=d(this),c=b.data("yiiActiveForm").attributes,e=-1,f=void 0;d.each(c,function(b){if(c[b].id==a)return e=b,f=c[b],!1});0<=e&&(c.splice(e,1),q(b,f).off(".yiiActiveForm"));return f},validateAttribute:function(a){a=m.find.call(this,a);void 0!=a&&r(d(this),a,!0)},find:function(a){var b=d(this).data("yiiActiveForm").attributes,c=void 0;d.each(b,function(d){if(b[d].id==a)return c=b[d],!1});return c},destroy:function(){return this.each(function(){d(this).unbind(".yiiActiveForm");
d(this).removeData("yiiActiveForm")})},data:function(){return this.data("yiiActiveForm")},validate:function(a){a&&(d(this).data("yiiActiveForm").submitting=!0);var b=d(this),c=b.data("yiiActiveForm"),e=!1,f={},g=y(),h=c.submitting&&!a;if(c.submitting&&(a=d.Event("beforeValidate"),b.trigger(a,[f,g]),!1===a.result)){c.submitting=!1;k(b);return}d.each(c.attributes,function(){this.$form=b;if(!d(this.input).is(":disabled")&&(this.cancelled=!1,c.submitting||2===this.status||3===this.status)){var a=f[this.id];
void 0===a&&(a=[],f[this.id]=a);var h=d.Event("beforeValidateAttribute");b.trigger(h,[this,a,g]);!1!==h.result?(this.validate&&this.validate(this,p(b,this),a,g,b),this.enableAjaxValidation&&(e=!0)):this.cancelled=!0}});d.when.apply(this,g).always(function(){for(var a in f)0===f[a].length&&delete f[a];if(e&&(d.isEmptyObject(f)||c.submitting)){a=c.submitObject;var g="&"+c.settings.ajaxParam+"="+b.attr("id");a&&a.length&&a.attr("name")&&(g+="&"+a.attr("name")+"="+a.attr("value"));d.ajax({url:c.settings.validationUrl,
type:b.attr("method"),data:b.serialize()+g,dataType:c.settings.ajaxDataType,complete:function(a,c){b.trigger("ajaxComplete",[a,c])},beforeSend:function(a,c){b.trigger("ajaxBeforeSend",[a,c])},success:function(a){null!==a&&"object"===typeof a?(d.each(c.attributes,function(){this.enableAjaxValidation&&!this.cancelled||delete a[this.id]}),t(b,d.extend(f,a),h)):t(b,f,h)},error:function(){c.submitting=!1;k(b)}})}else c.submitting?setTimeout(function(){t(b,f,h)},200):t(b,f,h)})},submitForm:function(){var a=
d(this),b=a.data("yiiActiveForm");if(b.validated){b.submitting=!1;var c=d.Event("beforeSubmit");a.trigger(c);if(!1===c.result)return b.validated=!1,k(a),!1;b=a.data("yiiActiveForm").submitObject||a.find(":submit:first");b.length&&"submit"==b.attr("type")&&b.attr("name")&&(c=d('input[type="hidden"][name="'+b.attr("name")+'"]',a),c.length?c.attr("value",b.attr("value")):d("<input>").attr({type:"hidden",name:b.attr("name"),value:b.attr("value")}).appendTo(a));return!0}h=d.Deferred();a.data("yiiSubmitFinalizePromise",
h.promise());void 0!==b.settings.timer&&clearTimeout(b.settings.timer);b.submitting=!0;m.validate.call(a);return!1},resetForm:function(){var a=d(this),b=a.data("yiiActiveForm");setTimeout(function(){d.each(b.attributes,function(){this.value=p(a,this);this.status=0;var c=a.find(this.container);c.removeClass(b.settings.validatingCssClass+" "+b.settings.errorCssClass+" "+b.settings.successCssClass);c.find(this.error).html("")});a.find(b.settings.errorSummary).hide().find("ul").html("")},1)},updateMessages:function(a,
b){var c=d(this),e=c.data("yiiActiveForm");d.each(e.attributes,function(){u(c,this,a)});b&&w(c,a)},updateAttribute:function(a,b){var c=m.find.call(this,a);if(void 0!=c){var e={};e[a]=b;u(d(this),c,e)}}},v=function(a,b){var c=q(a,b);if(b.validateOnChange)c.on("change.yiiActiveForm",function(){r(a,b,!1)});if(b.validateOnBlur)c.on("blur.yiiActiveForm",function(){0!=b.status&&1!=b.status||r(a,b,!0)});if(b.validateOnType)c.on("keyup.yiiActiveForm",function(c){-1===d.inArray(c.which,[16,17,18,37,38,39,
40])&&b.value!==p(a,b)&&r(a,b,!1,b.validationDelay)})},r=function(a,b,c,e){var f=a.data("yiiActiveForm");c&&(b.status=2);d.each(f.attributes,function(){this.value!==p(a,this)&&(this.status=2,c=!0)});c&&(void 0!==f.settings.timer&&clearTimeout(f.settings.timer),f.settings.timer=setTimeout(function(){f.submitting||a.is(":hidden")||(d.each(f.attributes,function(){2===this.status&&(this.status=3,a.find(this.container).addClass(f.settings.validatingCssClass))}),m.validate.call(a))},e?e:200))},y=function(){var a=
[];a.add=function(a){this.push(new d.Deferred(a))};return a},n=["action","target","method","enctype"],x=function(a){for(var b={},c=0;c<n.length;c++)b[n[c]]=a.attr(n[c]);return b},z=function(a,b){for(var c=0;c<n.length;c++){var d=b.attr("form"+n[c]);d&&a.attr(n[c],d)}},A=function(a){for(var b=a.data("yiiActiveForm"),c=0;c<n.length;c++)a.attr(n[c],b.options[n[c]]||null)},t=function(a,b,c){var e=a.data("yiiActiveForm");if(void 0===e)return!1;if(c){var f=[];d.each(e.attributes,function(){d(this.input).is(":disabled")||
this.cancelled||!u(a,this,b)||f.push(this)});a.trigger("afterValidate",[b,f]);w(a,b);if(f.length){if(e.settings.scrollToError){c=a.find(d.map(f,function(a){return a.input}).join(",")).first().closest(":visible").offset().top-e.settings.scrollToErrorOffset;0>c?c=0:c>d(document).height()&&(c=d(document).height());var g=d(window).scrollTop();(c<g||c>g+d(window).height())&&d(window).scrollTop(c)}e.submitting=!1}else e.validated=!0,e.submitObject&&z(a,e.submitObject),a.submit(),e.submitObject&&A(a)}else d.each(e.attributes,
function(){this.cancelled||2!==this.status&&3!==this.status||u(a,this,b)});k(a)},u=function(a,b,c){var e=a.data("yiiActiveForm"),f=q(a,b),g=!1;d.isArray(c[b.id])||(c[b.id]=[]);a.trigger("afterValidateAttribute",[b,c[b.id]]);b.status=1;if(f.length){g=0<c[b.id].length;f=a.find(b.container);var h=f.find(b.error),k=g;b.updateAriaInvalid&&a.find(b.input).attr("aria-invalid",k?"true":"false");g?(b.encodeError?h.text(c[b.id][0]):h.html(c[b.id][0]),f.removeClass(e.settings.validatingCssClass+" "+e.settings.successCssClass).addClass(e.settings.errorCssClass)):
(h.empty(),f.removeClass(e.settings.validatingCssClass+" "+e.settings.errorCssClass+" ").addClass(e.settings.successCssClass));b.value=p(a,b)}return g},w=function(a,b){var c=a.data("yiiActiveForm");a=a.find(c.settings.errorSummary);var e=a.find("ul").empty();a.length&&b&&(d.each(c.attributes,function(){if(d.isArray(b[this.id])&&b[this.id].length){var a=d("<li/>");c.settings.encodeErrorSummary?a.text(b[this.id][0]):a.html(b[this.id][0]);e.append(a)}}),a.toggle(0<e.find("li").length))},p=function(a,
b){b=q(a,b);var c=b.attr("type");return"checkbox"===c||"radio"===c?(c=b.filter(":checked"),c.length||(c=a.find('input[type=hidden][name="'+b.attr("name")+'"]')),c.val()):b.val()},q=function(a,b){a=a.find(b.input);return a.length&&"div"===a[0].tagName.toLowerCase()?a.find("input"):a}})(window.jQuery);
